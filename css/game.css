/* 게임 방 UI - 반응형 */

.game-wrap {
  width: 100%;
  /* 접시 링이 커질 수 있도록 560px까지 허용 (큰 화면에서 간격 확대) */
  max-width: min(560px, calc(100vw - 2rem));
  margin: 0 auto;
  padding: 0 clamp(0.5rem, 2vw, 1rem);
  box-sizing: border-box;
}

.game-room {
  margin-bottom: clamp(0.75rem, 2vw, 1rem);
  padding: clamp(0.6rem, 2vw, 0.75rem) clamp(0.75rem, 2vw, 1rem);
  background: linear-gradient(160deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.03) 100%);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: clamp(0.5rem, 2vw, 0.75rem);
  box-shadow:
    0 4px 24px rgba(0, 0, 0, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.06);
  box-sizing: border-box;
}

.game-room-players {
  display: flex;
  align-items: center;
  gap: clamp(0.25rem, 1.5vw, 0.4rem);
  min-width: 0;
}

.game-room-vs {
  flex-shrink: 0;
  font-size: clamp(0.65rem, 2vw, 0.75rem);
  font-weight: 800;
  color: rgba(255, 255, 255, 0.35);
  letter-spacing: 0.1em;
}

.player-slot {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(0.2rem, 0.8vw, 0.25rem);
  padding: clamp(0.4rem, 1.5vw, 0.5rem) clamp(0.5rem, 1.5vw, 0.6rem);
  border-radius: clamp(0.5rem, 1.5vw, 0.6rem);
  border: 2px solid rgba(255, 255, 255, 0.08);
  font-size: clamp(0.8rem, 2.5vw, 0.95rem);
  color: rgba(255, 255, 255, 0.9);
  background: rgba(0, 0, 0, 0.15);
  transition: border-color 0.2s, box-shadow 0.2s;
}

.player-label {
  font-size: clamp(0.6rem, 1.8vw, 0.7rem);
  font-weight: 700;
  color: rgba(255, 255, 255, 0.45);
  letter-spacing: 0.05em;
}

.player-info {
  display: flex;
  align-items: center;
  gap: clamp(0.25rem, 1.5vw, 0.4rem);
  flex-wrap: wrap;
  justify-content: center;
  min-width: 0;
}

.player-slot .player-name {
  font-size: clamp(0.8rem, 2.2vw, 0.9rem);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
}

.player-slot:first-of-type {
  border-left: 3px solid rgba(255, 200, 100, 0.5);
}

.player-slot:last-of-type {
  border-right: 3px solid rgba(255, 200, 100, 0.5);
}

.player-slot--me {
  border-color: rgba(74, 158, 255, 0.35);
  background: rgba(74, 158, 255, 0.08);
  box-shadow: 0 0 0 1px rgba(74, 158, 255, 0.2);
}

.player-slot--me .player-name {
  font-weight: 700;
  color: #6eb3ff;
}

.player-badge {
  font-size: clamp(0.6rem, 1.8vw, 0.7rem);
  padding: clamp(0.15rem, 0.5vw, 0.2rem) clamp(0.35rem, 1.2vw, 0.5rem);
  background: linear-gradient(135deg, rgba(74, 158, 255, 0.5) 0%, rgba(74, 158, 255, 0.25) 100%);
  color: #fff;
  border-radius: 0.35rem;
  font-weight: 700;
  letter-spacing: 0.02em;
}

/* 추후 턴일 때: 빨간 테두리 깜빡임 */
.player-slot--turn {
  border-color: #e85d5d !important;
  box-shadow: 0 0 12px rgba(232, 93, 93, 0.4);
  animation: turn-blink 0.8s ease-in-out infinite;
}

@keyframes turn-blink {
  50% {
    border-color: rgba(232, 93, 93, 0.5) !important;
    box-shadow: 0 0 8px rgba(232, 93, 93, 0.25);
  }
}

/* 플레이어별 토큰: 레디 전에는 숨김, 게임 시작 후 표시. 11개 초과 시 두 줄 */
.player-tokens {
  display: none;
  flex-wrap: wrap;
  justify-content: center;
  gap: clamp(0.2rem, 0.8vw, 0.25rem);
  margin-top: 0.35rem;
  max-width: min(11rem, 45vw);
}

.game-room--playing .player-tokens {
  display: flex;
}

.player-token {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
}

.player-token--p1 {
  background: linear-gradient(145deg, #6eb3ff 0%, #4a9eff 100%);
  box-shadow: 0 0 0 1px rgba(74, 158, 255, 0.5);
}

.player-token--p2 {
  background: linear-gradient(145deg, #ff9a6e 0%, #e85d5d 100%);
  box-shadow: 0 0 0 1px rgba(232, 93, 93, 0.5);
}

/* 닉네임 밑 토큰을 접시로 놓을 때 제거 애니메이션 */
.player-token.game-token--removing {
  animation: token-remove 0.3s ease-out forwards;
}

@keyframes token-remove {
  to {
    opacity: 0;
    transform: scale(0);
  }
}

.game-area {
  position: relative;
  min-height: clamp(180px, 45vw, 200px);
  padding: clamp(0.75rem, 2vw, 1rem);
  padding-top: clamp(1.25rem, 4vw, 2rem);
  background: rgba(0, 0, 0, 0.2);
  border-radius: 0.5rem;
  border: 1px dashed rgba(255, 255, 255, 0.15);
  margin-bottom: clamp(1rem, 3vw, 1.5rem);
  overflow: hidden;
  box-sizing: border-box;
}

/* 접시 링 컨테이너: ring이 있을 때 링 + 아래 영역을 세로 배치, 링은 정사각형 유지 */
#gameAreaContent:has(.game-plate-ring) {
  position: relative;
  width: 100%;
  /* 큰 화면: 560px까지 성장. 작은 화면: 100% (부모가 이미 좁음). 너무 좁아지지 않게 최소 260px */
  max-width: min(560px, calc(100vw - 2rem));
  min-width: min(260px, 100%);
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 0;
  /* 링과 아래 메인 콘텐츠 사이 간격 */
  gap: clamp(1rem, 4vw, 1.75rem);
  container-type: inline-size;
  container-name: plate-ring;
}

/* game-area 왼쪽/오른쪽 위: 토큰 x N개 (N = n(n-1)/2), 레디 후에만 표시 */
.game-area-token-label {
  display: none;
  position: absolute;
  top: 0.5rem;
  font-size: 0.8rem;
  font-weight: 600;
}

.game-area--playing .game-area-token-label {
  display: block;
}

/* 메인 게임 시작 시 '토큰 x N개' 표시 제거 (더 이상 사용 안 함) */
.game-area--main-phase .game-area-token-label {
  display: none;
}

.game-area-token-label--p1 {
  left: clamp(0.5rem, 2vw, 1rem);
  color: #6eb3ff;
  text-shadow: 0 0 4px rgba(74, 158, 255, 0.4);
  font-size: clamp(0.7rem, 2vw, 0.8rem);
}

.game-area-token-label--p2 {
  right: clamp(0.5rem, 2vw, 1rem);
  color: #ff9a6e;
  text-shadow: 0 0 4px rgba(232, 93, 93, 0.4);
  font-size: clamp(0.7rem, 2vw, 0.8rem);
}

.game-phase-label {
  margin: 0 0 0.75rem;
  font-size: clamp(0.85rem, 2.5vw, 0.9rem);
  font-weight: 600;
  color: rgba(255, 255, 255, 0.6);
  text-align: center;
}

.game-phase-label--playing {
  color: #6eb3ff;
}

.game-phase-label--waiting {
  color: rgba(255, 255, 255, 0.6);
  font-size: clamp(0.9rem, 2.5vw, 0.95rem);
}

.game-ready-btn {
  display: block;
  margin: 0 auto;
  padding: clamp(0.5rem, 2vw, 0.6rem) clamp(1rem, 4vw, 1.5rem);
  font-size: clamp(0.9rem, 2.5vw, 1rem);
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, #4a9eff 0%, #357abd 100%);
  border: none;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: opacity 0.2s;
  box-sizing: border-box;
}

.game-ready-btn:hover {
  opacity: 0.95;
}

.game-ready-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* 접시 링: 반응형. plate-radius는 화면이 좁아질수록 비율을 키워서 접시가 더 바깥으로 늘어남 */
.game-plate-ring {
  position: relative;
  width: 100%;
  aspect-ratio: 1;
  max-width: 100%;
  flex-shrink: 0;
  min-height: 0;
  --plate-ring-size: 100%;
  --plate-radius: 40%;
  --plate-size: 11.25%;
  --lid-radius: calc(var(--plate-radius) + var(--plate-size));
  /* translateY(%)는 요소 자신 높이 기준이므로, 링 기준 거리로 쓰려면 배율로 변환 (40/11.25 ≈ 3.56) */
  --plate-radius-translate: calc(100% * 40 / 11.25);
  --lid-radius-translate: calc(100% * 51.25 / 11.25);
}

/* 뚜껑: 기본 숨김, 클릭 시 .game-plate-lid--covered 추가하면 보이면서 덮히는 애니메이션 */
.game-plate-ring .game-plate-lid {
  visibility: hidden;
  opacity: 0;
}

.game-plate-ring .game-plate-lid.game-plate-lid--covered {
  visibility: visible;
  animation: lid-cover 2s ease-out both;
}

/* 벗길 때는 lid-cover 대신 lid-uncover만 재생 */
.game-plate-ring .game-plate-lid.game-plate-lid--covered.game-plate-lid--uncover {
  animation: lid-uncover 1.2s ease-in-out forwards;
}

@keyframes lid-cover {
  from {
    transform: rotate(var(--plate-angle)) translateY(calc(-1 * var(--lid-radius-translate))) rotate(calc(-1 * var(--plate-angle)));
    opacity: 0;
  }

  to {
    transform: rotate(var(--plate-angle)) translateY(calc(-1 * var(--plate-radius-translate))) rotate(calc(-1 * var(--plate-angle)));
    opacity: 1;
  }
}

.game-plate {
  position: absolute;
  left: 50%;
  top: 50%;
  width: var(--plate-size);
  height: var(--plate-size);
  margin-left: calc(var(--plate-size) / -2);
  margin-top: calc(var(--plate-size) / -2);
  border-radius: 50%;
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.95) 0%, rgba(240, 240, 240, 0.9) 100%);
  border: 2.5px solid rgba(255, 255, 255, 0.8);
  border-color: #a08060;
  box-shadow:
    inset 0 2px 6px rgba(255, 255, 255, 0.15),
    inset 0 -2px 4px rgba(0, 0, 0, 0.4),
    0 0 0 2px rgba(139, 115, 85, 0.6),
    0 4px 12px rgba(0, 0, 0, 0.5);
  transform: rotate(var(--plate-angle)) translateY(calc(-1 * var(--plate-radius-translate))) rotate(calc(-1 * var(--plate-angle)));
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: filter 0.15s, transform 0.15s;
  z-index: 1;
}

.game-plate:hover {
  filter: brightness(1.08);
}

.game-plate:active {
  filter: brightness(0.95);
}

/* 한 번 클릭한 접시: 다시 클릭 불가 */
.game-plate.game-plate--used {
  pointer-events: none;
  cursor: default;
  opacity: 0.65;
}

/* 메인 단계: 토큰 놓을 접시로 선택된 두 접시만 클릭 가능 */
.game-plate.game-plate--used.game-plate--placeable {
  pointer-events: auto;
  cursor: pointer;
  opacity: 1;
}

/* 접시 번호: --plate-angle 방향(링 중심→접시)으로 접시 밖에 배치 */
.game-plate-number {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) rotate(var(--plate-angle)) translateY(calc(50% - 3.2em)) rotate(calc(-1 * var(--plate-angle)));
  font-size: clamp(0.5rem, 3vw, 0.8rem);
  font-weight: 700;
  color: #e6c200;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.8), 0 1px 2px rgba(0, 0, 0, 0.6);
  line-height: 1;
  pointer-events: none;
  user-select: none;
  white-space: nowrap;
}

/* 접시 위 토큰: 격자로 정렬, 겹치지 않게. 뚜껑이 덮이면 z-index로 가려짐 */
.game-plate-tokens {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-auto-rows: 1fr;
  gap: 3px;
  max-width: calc(var(--plate-size) * 0.88);
  max-height: calc(var(--plate-size) * 0.88);
  aspect-ratio: 1;
  place-content: center;
  pointer-events: none;
}

.game-plate-token {
  width: 100%;
  aspect-ratio: 1;
  min-width: 3px;
  min-height: 3px;
  border-radius: 50%;
  justify-self: center;
  align-self: center;
}

.game-plate-token--p1 {
  background: linear-gradient(145deg, #6eb3ff 0%, #4a9eff 100%);
  box-shadow:
    inset 0 1px 1px rgba(255, 255, 255, 0.4),
    0 0 0 1px rgba(74, 158, 255, 0.5);
}

.game-plate-token--p2 {
  background: linear-gradient(145deg, #ff9a6e 0%, #e85d5d 100%);
  box-shadow:
    inset 0 1px 1px rgba(255, 255, 255, 0.4),
    0 0 0 1px rgba(232, 93, 93, 0.5);
}

/* 뚜껑: 접시와 같은 크기, 접시 바깥쪽에서 시작 → 덮힐 때 접시 위치로 이동. z-index로 접시·토큰 위에 그려져 덮이면 토큰 안 보임 */
.game-plate-lid {
  position: absolute;
  left: 50%;
  top: 50%;
  width: var(--plate-size);
  height: var(--plate-size);
  margin-left: calc(var(--plate-size) / -2);
  margin-top: calc(var(--plate-size) / -2);
  border-radius: 50%;
  background: linear-gradient(160deg, #8b7355 0%, #6b5344 40%, #5c4a3a 100%);
  border: 2.5px solid #7a6348;
  box-shadow:
    inset 0 2px 4px rgba(255, 255, 255, 0.12),
    inset 0 -2px 6px rgba(0, 0, 0, 0.5),
    0 0 0 2px rgba(60, 45, 35, 0.8),
    0 4px 10px rgba(0, 0, 0, 0.5);
  transform: rotate(var(--plate-angle)) translateY(calc(-1 * var(--lid-radius-translate))) rotate(calc(-1 * var(--plate-angle)));
  pointer-events: none;
  z-index: 2;
}

/* 메인 단계: 선수가 확인할 두 접시 선택 시 뚜껑 클릭 가능 */
.game-area--main-phase .game-plate-lid {
  pointer-events: auto;
  cursor: pointer;
}

.game-area--main-phase .game-plate-lid:hover {
  filter: brightness(1.1);
}

/* 메인 단계에서 선택한 뚜껑(포커스) */
.game-plate-lid.game-plate-lid--selected {
  box-shadow:
    inset 0 2px 4px rgba(255, 255, 255, 0.12),
    inset 0 -2px 6px rgba(0, 0, 0, 0.5),
    0 0 0 2px rgba(60, 45, 35, 0.8),
    0 0 0 4px rgba(230, 194, 0, 0.8),
    0 4px 10px rgba(0, 0, 0, 0.5);
}

/* 두 뚜껑 선택 후: 원래 자리(위)로 올라가며 사라지는 애니메이션 (--covered와 함께 있을 때는 위 규칙에서 적용) */
.game-plate-lid.game-plate-lid--uncover {
  animation: lid-uncover 1.2s ease-in-out forwards;
}

@keyframes lid-uncover {
  from {
    transform: rotate(var(--plate-angle)) translateY(calc(-1 * var(--plate-radius-translate))) rotate(calc(-1 * var(--plate-angle)));
    opacity: 1;
    visibility: visible;
  }

  to {
    transform: rotate(var(--plate-angle)) translateY(calc(-1 * var(--lid-radius-translate))) rotate(calc(-1 * var(--plate-angle)));
    opacity: 0;
    visibility: hidden;
  }
}

.game-center-zone {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(0.6rem, 2.5vw, 1rem);
  min-width: 80px;
  max-width: min(200px, 85vw);
  text-align: center;
}

.game-timer {
  font-size: clamp(1rem, 3.5vw, 1.25rem);
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  color: rgba(255, 255, 255, 0.9);
}

.game-timer--hidden {
  visibility: hidden;
}

.game-center-message {
  min-height: 2.5rem;
  width: 100%;
  max-width: 200px;
  padding: clamp(0.5rem, 2vw, 0.75rem) clamp(0.75rem, 2.5vw, 1rem);
  font-size: clamp(0.8rem, 2.5vw, 0.95rem);
  color: #e6c200;
  text-align: center;
  background: rgba(230, 194, 0, 0.08);
  border-radius: 0.5rem;
  border: 1px solid rgba(230, 194, 0, 0.25);
  box-sizing: border-box;
}

.game-center-message .game-center-highlight {
  color: #ff4444;
  font-size: 1.15em;
  font-weight: 700;
}

.game-main-content {
  min-height: clamp(60px, 20vw, 80px);
  width: 100%;
  padding: clamp(0.25rem, 1.5vw, 0.5rem) 0;
  box-sizing: border-box;
}

.game-wrap .lobby-actions {
  margin-top: 0;
}

.game-wrap .lobby-actions a {
  display: block;
  text-align: center;
  padding: clamp(0.6rem, 2vw, 0.75rem);
  color: #4a9eff;
  text-decoration: none;
  border: 1px solid rgba(74, 158, 255, 0.4);
  border-radius: 0.5rem;
  font-size: clamp(0.9rem, 2.5vw, 1rem);
  box-sizing: border-box;
}

.game-wrap .lobby-actions a:hover {
  background: rgba(74, 158, 255, 0.15);
}

/* 게임 중 '본인 차례가 아닐 때' 클릭 시 공지 */
.game-notice {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1000;
  padding: clamp(0.75rem, 3vw, 1rem) clamp(1rem, 4vw, 1.5rem);
  font-size: clamp(0.85rem, 2.5vw, 0.95rem);
  color: rgba(255, 255, 255, 0.95);
  background: rgba(0, 0, 0, 0.85);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: clamp(0.5rem, 2vw, 0.75rem);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  pointer-events: none;
  animation: game-notice-in 0.2s ease-out;
  max-width: calc(100vw - 2rem);
  box-sizing: border-box;
}

@keyframes game-notice-in {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.95);
  }

  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}